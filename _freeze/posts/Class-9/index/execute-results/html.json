{
  "hash": "81ada9334080c596492b484bb25bc16f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Testing-a-Single-Proportion\"\nauthor: \"Anusha\"\n---\n\n\n\n## CLT for Proportions\n\nMy metric is not a mean, it is a proportion.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(mosaic)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'mosaic':\n  method                           from   \n  fortify.SpatialPolygonsDataFrame ggplot2\n\nThe 'mosaic' package masks several functions from core packages in order to add \nadditional features.  The original behavior of these functions should not be affected by this.\n\nAttaching package: 'mosaic'\n\nThe following object is masked from 'package:Matrix':\n\n    mean\n\nThe following objects are masked from 'package:dplyr':\n\n    count, do, tally\n\nThe following object is masked from 'package:purrr':\n\n    cross\n\nThe following object is masked from 'package:ggplot2':\n\n    stat\n\nThe following objects are masked from 'package:stats':\n\n    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,\n    quantile, sd, t.test, var\n\nThe following objects are masked from 'package:base':\n\n    max, mean, min, prod, range, sample, sum\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggformula)\nlibrary(infer)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'infer'\n\nThe following objects are masked from 'package:mosaic':\n\n    prop_test, t_test\n```\n\n\n:::\n\n```{.r .cell-code}\n## Datasets from Chihara and Hesterberg's book (Second Edition)\nlibrary(resampledata)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'resampledata'\n\nThe following object is masked from 'package:datasets':\n\n    Titanic\n```\n\n\n:::\n\n```{.r .cell-code}\n## Datasets from Cetinkaya-Rundel and Hardin's book (First Edition)\nlibrary(openintro)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: airports\nLoading required package: cherryblossom\nLoading required package: usdata\n\nAttaching package: 'openintro'\n\nThe following object is masked from 'package:mosaic':\n\n    dotPlot\n\nThe following objects are masked from 'package:lattice':\n\n    ethanol, lsegments\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(yrbss, package = \"openintro\")\nyrbss\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 13,583 × 13\n     age gender grade hispanic race                     height weight helmet_12m\n   <int> <chr>  <chr> <chr>    <chr>                     <dbl>  <dbl> <chr>     \n 1    14 female 9     not      Black or African Americ…  NA      NA   never     \n 2    14 female 9     not      Black or African Americ…  NA      NA   never     \n 3    15 female 9     hispanic Native Hawaiian or Othe…   1.73   84.4 never     \n 4    15 female 9     not      Black or African Americ…   1.6    55.8 never     \n 5    15 female 9     not      Black or African Americ…   1.5    46.7 did not r…\n 6    15 female 9     not      Black or African Americ…   1.57   67.1 did not r…\n 7    15 female 9     not      Black or African Americ…   1.65  132.  did not r…\n 8    14 male   9     not      Black or African Americ…   1.88   71.2 never     \n 9    15 male   9     not      Black or African Americ…   1.75   63.5 never     \n10    15 male   10    not      Black or African Americ…   1.37   97.1 did not r…\n# ℹ 13,573 more rows\n# ℹ 5 more variables: text_while_driving_30d <chr>, physically_active_7d <int>,\n#   hours_tv_per_school_day <chr>, strength_training_7d <int>,\n#   school_night_hours_sleep <chr>\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nyrbss %>%\n  group_by(helmet_12m) %>%\n  count()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 × 2\n# Groups:   helmet_12m [7]\n  helmet_12m       n\n  <chr>        <int>\n1 always         399\n2 did not ride  4549\n3 most of time   293\n4 never         6977\n5 rarely         713\n6 sometimes      341\n7 <NA>           311\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n##\nyrbss %>%\n  group_by(text_while_driving_30d) %>%\n  count()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 9 × 2\n# Groups:   text_while_driving_30d [9]\n  text_while_driving_30d     n\n  <chr>                  <int>\n1 0                       4792\n2 1-2                      925\n3 10-19                    373\n4 20-29                    298\n5 3-5                      493\n6 30                       827\n7 6-9                      311\n8 did not drive           4646\n9 <NA>                     918\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nno_helmet_text <- yrbss %>%\n  filter(helmet_12m == \"never\") %>%\n  mutate(text_ind = ifelse(text_while_driving_30d == \"30\", \"yes\", \"no\")) %>%\n  # removing most of the other variables\n  select(age, gender, text_ind)\nno_helmet_text\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6,977 × 3\n     age gender text_ind\n   <int> <chr>  <chr>   \n 1    14 female no      \n 2    14 female <NA>    \n 3    15 female yes     \n 4    15 female no      \n 5    14 male   <NA>    \n 6    15 male   <NA>    \n 7    16 male   no      \n 8    14 male   no      \n 9    15 male   no      \n10    16 male   no      \n# ℹ 6,967 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n##\nno_helmet_text %>%\n  drop_na() %>%\n  count(text_ind)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 2\n  text_ind     n\n  <chr>    <int>\n1 no        6025\n2 yes        462\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n##\nno_helmet_text %>%\n  drop_na() %>%\n  summarize(prop = prop(text_ind, success = \"yes\"), n = n())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n    prop     n\n   <dbl> <int>\n1 0.0712  6487\n```\n\n\n:::\n:::\n\n\n\n### Visualizing a single proportion\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set graph theme\n#theme_set(new = theme_custom())\n#\nno_helmet_text %>%\n  drop_na() %>%\n  gf_bar(~text_ind) %>%\n  gf_labs(\n    x = \"texted?\",\n    title = \"High-Schoolers who texted every day\",\n    subtitle = \"While driving with no helmet on!!\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n### **Hypothesis Testing for a Single Proportion**\n\nClassical test: Simple test in R called binom.test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmosaic::binom.test(~text_ind, data = no_helmet_text, success = \"yes\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\n\ndata:  no_helmet_text$text_ind  [with success = yes]\nnumber of successes = 463, number of trials = 6503, p-value < 2.2e-16\nalternative hypothesis: true probability of success is not equal to 0.5\n95 percent confidence interval:\n 0.06506429 0.07771932\nsample estimates:\nprobability of success \n            0.07119791 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmosaic::binom.test(~text_ind, data = no_helmet_text, success = \"yes\") %>%\n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 7\n  estimate statistic p.value parameter conf.low conf.high alternative\n     <dbl>     <dbl>   <dbl>     <dbl>    <dbl>     <dbl> <chr>      \n1   0.0712       463       0      6503   0.0651    0.0777 two.sided  \n```\n\n\n:::\n:::\n\n\n\nThis is a good estimate for children who drive and text.\n\nIt consists of 7% of the population.\n\nBootstrap test:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nno_helmet_text %>%\n  drop_na() %>%\n  specify(response = text_ind, success = \"yes\") %>%\n  generate(reps = 999, type = \"bootstrap\") %>%\n  calculate(stat = \"prop\") %>%\n  get_ci(level = 0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n  lower_ci upper_ci\n     <dbl>    <dbl>\n1   0.0652   0.0771\n```\n\n\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}