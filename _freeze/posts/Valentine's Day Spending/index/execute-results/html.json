{
  "hash": "815a13253dbbe411ecbb893399069d82",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"A2(Part-2)\"\nauthor: \"Anusha\"\norder: 8\n---\n\n\n\n# \"Valentine's Day Spending\"\n\n# Introduction\n\nI have chosen the 'Valentine's Day Spending' data set.\n\nFirst, let's take a look at the data set provided. To do this we need to do a basic set up.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(mosaic)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'mosaic':\n  method                           from   \n  fortify.SpatialPolygonsDataFrame ggplot2\n\nThe 'mosaic' package masks several functions from core packages in order to add \nadditional features.  The original behavior of these functions should not be affected by this.\n\nAttaching package: 'mosaic'\n\nThe following object is masked from 'package:Matrix':\n\n    mean\n\nThe following objects are masked from 'package:dplyr':\n\n    count, do, tally\n\nThe following object is masked from 'package:purrr':\n\n    cross\n\nThe following object is masked from 'package:ggplot2':\n\n    stat\n\nThe following objects are masked from 'package:stats':\n\n    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,\n    quantile, sd, t.test, var\n\nThe following objects are masked from 'package:base':\n\n    max, mean, min, prod, range, sample, sum\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(skimr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'skimr'\n\nThe following object is masked from 'package:mosaic':\n\n    n_missing\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggformula)\nlibrary(ggprism)\n```\n:::\n\n\n\nNext, let us read this file:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngifts_age <- read_delim(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-02-13/gifts_age.csv\", delim = \",\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 6 Columns: 9\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): Age\ndbl (8): SpendingCelebrating, Candy, Flowers, Jewelry, GreetingCards, Evenin...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\ngifts_age\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 9\n  Age   SpendingCelebrating Candy Flowers Jewelry GreetingCards EveningOut\n  <chr>               <dbl> <dbl>   <dbl>   <dbl>         <dbl>      <dbl>\n1 18-24                  51    70      50      33            33         41\n2 25-34                  40    62      44      34            33         37\n3 35-44                  31    58      41      29            42         30\n4 45-54                  19    60      37      20            42         31\n5 55-64                  18    50      32      13            43         29\n6 65+                    13    42      25       8            44         24\n# ℹ 2 more variables: Clothing <dbl>, GiftCards <dbl>\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(gifts_age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 6\nColumns: 9\n$ Age                 <chr> \"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\"\n$ SpendingCelebrating <dbl> 51, 40, 31, 19, 18, 13\n$ Candy               <dbl> 70, 62, 58, 60, 50, 42\n$ Flowers             <dbl> 50, 44, 41, 37, 32, 25\n$ Jewelry             <dbl> 33, 34, 29, 20, 13, 8\n$ GreetingCards       <dbl> 33, 33, 42, 42, 43, 44\n$ EveningOut          <dbl> 41, 37, 30, 31, 29, 24\n$ Clothing            <dbl> 33, 27, 26, 20, 19, 12\n$ GiftCards           <dbl> 23, 19, 22, 23, 20, 20\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninspect(gifts_age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\ncategorical variables:  \n  name     class levels n missing                                  distribution\n1  Age character      6 6       0 18-24 (16.7%), 25-34 (16.7%) ...             \n\nquantitative variables:  \n                 name   class min    Q1 median    Q3 max     mean        sd n\n1 SpendingCelebrating numeric  13 18.25   25.0 37.75  51 28.66667 14.733183 6\n2               Candy numeric  42 52.00   59.0 61.50  70 57.00000  9.777525 6\n3             Flowers numeric  25 33.25   39.0 43.25  50 38.16667  8.886319 6\n4             Jewelry numeric   8 14.75   24.5 32.00  34 22.83333 10.870449 6\n5       GreetingCards numeric  33 35.25   42.0 42.75  44 39.50000  5.089204 6\n6          EveningOut numeric  24 29.25   30.5 35.50  41 32.00000  6.066300 6\n7            Clothing numeric  12 19.25   23.0 26.75  33 22.83333  7.359801 6\n8           GiftCards numeric  19 20.00   21.0 22.75  23 21.16667  1.722401 6\n  missing\n1       0\n2       0\n3       0\n4       0\n5       0\n6       0\n7       0\n8       0\n```\n\n\n:::\n:::\n\n\n\nAccording to the glimpse, Age is currently a \\<chr\\>. Since it has only 6 levels (according to inspect), we convert it onto a factor.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvalentines <- gifts_age %>% \n  mutate(\n    Age = as_factor(Age)\n  )\ninspect(valentines)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\ncategorical variables:  \n  name  class levels n missing                                  distribution\n1  Age factor      6 6       0 18-24 (16.7%), 25-34 (16.7%) ...             \n\nquantitative variables:  \n                 name   class min    Q1 median    Q3 max     mean        sd n\n1 SpendingCelebrating numeric  13 18.25   25.0 37.75  51 28.66667 14.733183 6\n2               Candy numeric  42 52.00   59.0 61.50  70 57.00000  9.777525 6\n3             Flowers numeric  25 33.25   39.0 43.25  50 38.16667  8.886319 6\n4             Jewelry numeric   8 14.75   24.5 32.00  34 22.83333 10.870449 6\n5       GreetingCards numeric  33 35.25   42.0 42.75  44 39.50000  5.089204 6\n6          EveningOut numeric  24 29.25   30.5 35.50  41 32.00000  6.066300 6\n7            Clothing numeric  12 19.25   23.0 26.75  33 22.83333  7.359801 6\n8           GiftCards numeric  19 20.00   21.0 22.75  23 21.16667  1.722401 6\n  missing\n1       0\n2       0\n3       0\n4       0\n5       0\n6       0\n7       0\n8       0\n```\n\n\n:::\n:::\n\n\n\n**Qualitative Data:\\~**\n\n-   Age\n\n**Quantitative Data:\\~**\n\n-   SpendingCelebrating\n\n-   Candy\n\n-   Flowers\n\n-   Jewelry\n\n-   GreetingCards\n\n-   EveningOut\n\n-   Clothing\n\n-   GiftCards\n\n**Insights:\\~**\n\n-   this data set has 6 rows and 9 columns.\n\n### Define Target variable and Predictor Variables\n\n-   **Target variable:** Amount spent per gift\n\n-   **Predictor variables:** Age Group\n\n### What could be the Research experiment that might have been conducted to obtain this data?\n\nThe main aim of the study would be to understand how much different age groups spend on various types of gifts for Valentine's Day. This can help businesses tailor their marketing strategies and product offerings based on consumer behavior.\n\nHow could it have been conducted?\n\n-   A structured questionnaire could be designed to collect data on spending habits for Valentine's Day gifts.\n\n-   The target population would include individuals who celebrate Valentine's Day across various age groups.\n\n-   Once the data is collected, it could be analyzed to identify trends and patterns in spending behavior.\n\n-   The resulting data from this research experiment would provide valuable insights into consumer behavior during Valentine's Day.\n\n### Plotting the graph\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# library(ggformula)\n\n# valentines_data <- data.frame(\n#   Age = factor(c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")),\n#   SpendingCelebrating = c(51, 40, 31, 19, 18, 13),\n#   item = c(\"Candy\", \"Flowers\", \"Jewelry\", \"GreetingCards\", \"EveningOut\", \"Clothing\", \"GiftCards\"),\n#   spending = c(70, 50, 33, 33, 41, 33, 23)\n# )\n\n# gf_line(spending ~ Age, \n#         color = ~ item, \n#         group = ~ item, \n#         data = valentines_data) %>%\n#   gf_point(spending ~ Age, \n#            color = ~ item, \n#            shape = ~ item, \n#            size = 3, \n#            data = valentines_data) %>%\n#   gf_labs(x = \"Age Group\", \n#           y = \"Amount Spent on Gifts\", \n#           title = \"Valentine's Day Spending by Age and Gift Type\", \n#           color = \"Gift Type\", \n#           shape = \"Gift Type\") +\n#   theme(legend.position = \"right\")\n```\n:::\n\n\n\n### Questions\n\n**Questions the below graph seeks to answer**\n\n1.  How does Valentine's Day spending vary across different age groups and gift categories?\n    -   As age increases, spending decreases. Younger people usually like to spend more on Valentine's Day.\n2.  Which age group spends the most on Valentine's Day?\n    -   Ages 18-24 spend the most. Momentarily 35-44 also spend.\n3.  Which age group spends the least on Valentine's day?\n    -   Ages 65+\n4.  Are there any noticeable trends in spending patterns as age increases?\n    -   As age increases, spending decreases.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggformula)\n\n# Correct data: Each age group has a corresponding spending value for each item.\nvalentines_data <- data.frame(\n  Age = factor(rep(c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\"), each = 7)),\n  SpendingCelebrating = rep(c(51, 40, 31, 19, 18, 13), each = 7),\n  item = rep(c(\"Candy\", \"Flowers\", \"Jewelry\", \"GreetingCards\", \"EveningOut\", \"Clothing\", \"GiftCards\"), times = 6),\n  spending = c(70, 50, 33, 33, 41, 33, 23,  # 18-24\n               62, 44, 34, 33, 37, 27, 19,  # 25-34\n               58, 41, 29, 42, 30, 26, 22,  # 35-44\n               60, 37, 20, 42, 31, 20, 23,  # 45-54\n               50, 32, 13, 43, 29, 19, 20,  # 55-64\n               42, 25, 8, 44, 24, 12, 20))  # 65+\n\n\n# Line and scatter plot using gf_line and gf_point\nvalentines_data %>%\n  gf_line(spending ~ Age, \n          color = ~ item, \n          group = ~ item) %>%\n  gf_point(spending ~ Age, \n           color = ~ item, \n           shape = ~ item, \n           size = 3) %>%\n  gf_labs(x = \"Age Group in Years\", \n          y = \"Amount Spent on Gifts\", \n          title = \"Valentine's Day Spending by Age and Gift Type\", \n          color = \"Gift Type\", \n          shape = \"Gift Type\") +\n  theme(legend.position = \"right\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: The shape palette can deal with a maximum of 6 discrete values because more\nthan 6 becomes difficult to discriminate\nℹ you have requested 7 values. Consider specifying shapes manually if you need\n  that many have them.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 6 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\nTo explain the code above:\n\n-   data.frame creates a data frame in R, a table-like structure for organizing data.\n\n    -   Why to use data.frame and rep?\n\n    -   Even if it looks complicated, we need to do this since the number of objects in the required columns are not equal.\n\n    -   The data.frame function helps organize data into a tabular structure with equal-length columns. When some columns have fewer elements, we use the rep function to ensure that all columns have the same number of objects.\n\n-   The rep function is used to repeat the age groups (\"18-14\", \"25-34\", etc.) seven times each (indicating that each age group has spending data for seven different items).\n\n-   SpendingCelebrating contains values (51, 40, 31, 19, 18, 13) repeated seven times each, representing a fixed amount for each age group.\n\n-   Item represents the types of gifts. The rep function repeats this list of items six times, which corresponds to the six age groups.\n\n-   Spending column holds he actual spending amounts for each gift item within each age group.\n\n-   gf_line initializes a line plot. The age group is on the x-axis and y-axis has the amount spent on gifts.\n\n-   gf_plot initializes a scatter plot, with the same x and y-axis.\n\n-   gf_lab helps to label the plot.\n\n-   theme(legend.position = \"right\") sets the legend on the right of the plot.\n\n#### What might be the Hypothesis / Research Question, based on the Chart?\n\n-   There are significant differences in the amount spent on Valentine's Day gifts across different age groups.\n-   Different age groups have distinct preferences for gift items on Valentine's Day.\n\n### My Story\n\nHonestly, I chose this data set because it had a low reading time and it looks fairly simple to figure out. Little did I know it would be a lot harder than it seemed.\n\nThe graph code was an issue and the first few codes I tried did not work at all. So, I kept trying to get the ggformula code to work. I did not want use ggplot, since what I had learnt properly was ggformula (gf_bar, gf_point, etc.). I kept tinkering with the code till I got the plotting code right. But it threw me an error. The number of objects in the required column were not equal. So, I had to find out the code for making the number objects equal which was quite an ordial to find. It took me while to understand how it worked. I also had figure out how to bring each of the gifts into a single column. This would make it easier for me to plot. Another new thing I learnt from this data set was how to use shapes. This is an interesting addition to the graph which helps us differentiate the points in the graphs and also makes it more visually appealing and understanding.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}